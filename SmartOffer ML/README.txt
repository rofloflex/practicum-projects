OneClick Insight: персонализированный маркетинг через машинное обучение

Описание проекта
OneClick Insight — это проект по машинному обучению, разработанный для интернет-магазина «В один клик». 
Цель проекта — предсказать снижение покупательской активности и помочь компании сосредоточиться на удержании существующих 
клиентов с помощью персонализированных предложений, основанных на анализе данных.

Выступая в роли стажёра отдела цифровых технологий, вам необходимо:
Предсказать, снизится ли активность клиента в течение следующих трёх месяцев.
Сегментировать клиентов по прибыльности и вероятности снижения активности.
Подготовить бизнес-рекомендации на основе модели.

Описание данных
Проект использует следующие наборы данных:

1. market_file.csv
Основная информация о клиентах:
id: идентификатор клиента
Покупательская активность: целевая переменная — 'снизилась' или 'прежний уровень'
Поведение клиентов, история покупок, взаимодействие с сайтом

2. market_money.csv
Выручка по каждому клиенту за разные периоды:
Период: например, 'текущий_месяц'
Выручка: суммарная выручка

3. market_time.csv
Затраченное клиентом время на сайте:
минут: суммарное время по периодам

4. money.csv
Средняя прибыль по клиенту:
Прибыль: прибыль за последние 3 месяца

Этапы проекта
Шаг 1: Загрузка и проверка данных
Импорт CSV-файлов

Обработка разделителей, кодировки и пропущенных значений

Шаг 2: Предобработка
Импутация пропусков (SimpleImputer)

Кодирование категориальных признаков (OneHotEncoder, OrdinalEncoder)

Масштабирование числовых признаков (StandardScaler, MinMaxScaler)

Шаг 3: Исследовательский анализ (EDA)
Анализ снижения активности

Фильтрация клиентов, активных минимум 3 месяца

Шаг 4: Объединение и генерация признаков
Агрегация данных по выручке и времени

Объединение всех датасетов в единый датафрейм для моделирования

Шаг 5: Корреляция и мультиколлинеарность
Анализ взаимосвязей между признаками

Удаление/объединение сильно коррелирующих переменных

Шаг 6: Обучение моделей
Используемые модели:
KNeighborsClassifier
DecisionTreeClassifier
LogisticRegression
SVC

Гиперпараметры подбирались через RandomizedSearchCV, метрика — roc_auc.

Шаг 7: Интерпретация модели (SHAP)
Использование SHAP для оценки важности признаков
Визуализация влияния признаков на предсказания

Шаг 8: Сегментация клиентов и рекомендации
Классификация клиентов по вероятности снижения активности и прибыльности
Подготовка бизнес-стратегий для ключевых сегментов

Результаты
Для поиска лучшей модели был написан пайплайн, в котором перебирались способы масштабирования данных, модели и гиперпараметры к ним. 
Лучшая можель - LogisticRegression(C=4, penalty='l1', random_state=42, solver='liblinear')). 
Метрика ROC_AUC на тренеровочной 0.90, на тестовой 0.91.
К значимым признакам относятся: Минуты предыдущий месяц. популярная категория кухонная посуда. разрешить сообщать нет и тип сервиса.
К самым малозначимым относятся: выручка предыдущий месяц. неоплаченные продукты штук квартал. маркет актив 6 мес.
Предложения бизнесу:

Переработать премиум, неплохой идеей было бы дать пробный премиум тем, у кого снижается активность.
Сделать акции на главной странице для товаров для детей.


Используемые технологии
Язык программирования: Python
Библиотеки: Pandas, NumPy, Scikit-learn, SHAP, Matplotlib, Seaborn
ML-инструменты: Pipeline, ColumnTransformer, GridSearchCV/RandomizedSearchCV
Визуализация и интерпретация: SHAP